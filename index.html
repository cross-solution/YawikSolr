<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="None">
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Solr</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body class="homepage">
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href=".">Solr</a>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#solr" class="nav-link">Solr</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#available-configuration-options" class="nav-link">Available configuration options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p>.. index:: Solr
.. _solr:</p>
<h2 id="solr">Solr</h2>
<p>.. sidebar:: Solr</p>
<p>=======================  ==========================================
   <code>Repository</code>            <code>yawik/solr</code>_
   <code>coverage</code>              |coverage|
   <code>buid</code>                  |build|
   =======================  ==========================================</p>
<p>.. |coverage| raw:: html</p>
<pre><code>&lt;a href='https://coveralls.io/github/yawik/Solr?branch=develop'&gt;&lt;img src='https://coveralls.io/repos/github/yawik/Solr/badge.svg?branch=develop' alt='Coverage Status' /&gt;&lt;/a&gt;
</code></pre>
<p>.. |build| raw:: html</p>
<pre><code>    &lt;a href="https://travis-ci.org/yawik/Solr"&gt;&lt;img src="https://travis-ci.org/yawik/Solr.svg?branch=master"&gt;&lt;/a&gt;
</code></pre>
<p>Requirements
^^^^^^^^^^^^</p>
<p>current development is using:</p>
<ul>
<li>php5-solr (pecl &gt;= 2.4.0)</li>
<li>apache solr (6.6.5) (solr &gt;7 is currently not working)</li>
</ul>
<p>.. note:: Debian 8 ships with php5-solr 1.0.2. You can build your solr extension by:</p>
<pre><code>.. code-block:: sh

    aptitude install php5-dev libcurl4-openssl-dev libxml2-dev
    pecl install solr
    echo "extension=solr.so" &gt; /etc/php5/mods-available/solr.ini
    php5enmod solr
    php -m| grep solr # should show the activated solr extension
</code></pre>
<p>Good resources on how to install solr:</p>
<ul>
<li>https://cwiki.apache.org/confluence/display/solr/Installing+Solr</li>
<li>http://nl3.php.net/manual/en/solr.installation.php</li>
</ul>
<p>Here is the way we've installed it in our Demo. First, you need JAVA. On Debian 8 you can install it via:</p>
<p>.. code-block:: sh</p>
<pre><code>apt install -t jessie-backports  openjdk-8-jre-headless ca-certificates-java
</code></pre>
<p>then get a binary version of solr. The binary package contains an installation script. So unzip/untar it and execute the
installation script. By default you'll find your solr server in :file:<code>/opt/solr/</code>. The solr data are stored in
:file:<code>/var/solr/data/</code>. After the installation you can remove the downloaded and extracted files.</p>
<p>.. code-block:: sh</p>
<blockquote>
<p>wget https://www-us.apache.org/dist/lucene/solr/6.6.5/solr-6.6.5.tgz
tar xzf solr-6.6.5.tgz
solr-6.6.5/bin/install_solr_service.sh solr-6.6.5.tgz</p>
</blockquote>
<p>After the installation, solr server ist running at localhost port 8983. This is enough for yawik to be able the access
the solr Server.</p>
<p>If you want to be able the access the solr frontend via https without touching the solr installation at all, an apache
proxy may be a solution. If you want to use this solution, you have to enable the apache proxy module.</p>
<p>.. code-block:: sh</p>
<pre><code>&gt; a2enmod proxy proxy_http
</code></pre>
<p>For setting up an apache Proxy you can use a Virtual Host which looks like</p>
<p>.. code-block:: sh</p>
<pre><code>&lt;VirtualHost *:8443&gt;

     ProxyRequests Off
     &lt;Proxy *&gt;
        AuthType Basic
        AuthName "Solr Search"
        AuthBasicProvider file
        AuthUserFile /etc/apache2/solr.passwd
        Require valid-user
        Order deny,allow
        Allow from all
     &lt;/Proxy&gt;

     ProxyPass / http://localhost:8983/
     ProxyPassReverse / http://localhost:8983/

&lt;/VirtualHost&gt;
</code></pre>
<p>Set the the user/pass in :file:<code>/etc/apache2/solr.passwd</code> via :command:<code>htpasswd /etc/apache2/solr.passwd username</code></p>
<p>Installation
^^^^^^^^^^^^</p>
<p>to install the <code>yawik/solr</code>_ Modul into a running YAWIK, change into the <code>YAWIK/modules</code> directory and clone
the yawik/solr module .</p>
<p>.. code-block:: sh</p>
<p>git clone https://github.com/yawik/Solr</p>
<p>To activate the module create a php file named <code>WhateverYouWant.module.php</code> in your config autoload directory containing:</p>
<p>.. code-block:: php</p>
<p>&lt;?php
 return ['Solr'];</p>
<p>To configure the solr connection copy the Solr options file into you autoload directory and adjust the values.</p>
<h1 id="available-configuration-options">Available configuration options</h1>
<p>.. table:: Options
    :widths: auto</p>
<pre><code>====================== ============== ===================================================================================
 Option                 Type           Description
====================== ============== ===================================================================================
 secure                 bool           Use SSL (https) [true] or not [false]
 hostname               string         Hostname of the solr server
 port                   int            The TCP port. Default: 8983
 username               string         Username used for HTTP Authentication (if needed)
 password               string         Password of the HTTP Authentocation
 jobsPath               string         The path to the solr jobs index
 facetFields            array          List of facet fields. Each entry must be an array with at least the key "name".
                                       An optional key "label" specifies a headline for the factes results.
 facetLimit             int            Maps to facet.limit. Sets the maximum number of constraint counts that should be
                                       returned for the facet fields.
 facetMinCount          int            Sets the minimum counts for facet fields that should be included in the response
 parameterNames         array          Maps query parameter names to solr field names. (see `.dist file`_ for examples)
 sorts                  array          Specify the sort order used for an empty search.
                                       Must be an associated array where the key is the field name and the value
                                       is the sort order.
                                       (Default: [ "datePublishStart" =&gt; \SolrQuery::ORDER_DESC ] )
 filterQueries          array          todo
 boostQueries           array          todo
====================== ============== ===================================================================================
</code></pre>
<p>.. _.dist file: https://github.com/yawik/Solr/blob/master/config/solr.moduleoptions.local.php.dist</p>
<p>.. code-block:: sh</p>
<p>cp module/Solr/config/solr.moduleoptions.local.php.dist config/autoload/solr.moduleoptions.local.php</p>
<p>.. note::</p>
<p>Solr needs a schema. The schema is currently a work in progress. You can use the schema in <code>Solr/contrib</code>_.</p>
<p>.. _yawik/solr: https://github.com/yawik/Solr
.. _Solr/contrib: https://github.com/yawik/Solr/tree/master/contrib</p>
<p>.. note:: at least one field needs JTS. So if you want to use the contributed schema, you have to install JTS
    via:</p>
<pre><code>.. code-block:: sh

    mkdir tmp
    cd tmp
    wget wget https://downloads.sourceforge.net/project/jts-topo-suite/jts/1.14/jts-1.14.zip
    unzip jts-1.14.zip
    cp lib/*.jar /opt/solr-6.6.0/server/solr-webapp/webapp/WEB-INF/lib/


Or take a look at the issue https://github.com/yawik/Solr/issues/4 . Maybe the fiels using JTS is not needed by
YAWIK any more.
</code></pre>
<p>If you want to set a user/password for solr you first have to enable an <code>Authorization Plugin</code>_.  Since Solr6 you can do
so by copying the following json to :file:<code>/var/solr/data/security.json</code></p>
<p>.. ::</p>
<pre><code>{
"authentication":{
   "blockUnknown": true,
   "class":"solr.BasicAuthPlugin",
   "credentials":{"solr":"IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c="}
},
"authorization":{
   "class":"solr.RuleBasedAuthorizationPlugin",
   "permissions":[{"name":"security-edit",
      "role":"admin"}],
   "user-role":{"solr":"admin"}
}}
</code></pre>
<p>This will add a user "solr" with the password "SolrRocks". After that you can change the password with</p>
<p>.. _Authorization Plugin: https://lucene.apache.org/solr/guide/6_6/basic-authentication-plugin.html</p>
<p>.. code-block:: sh</p>
<pre><code>curl --user solr:SolrRocks http://localhost:8983/solr/admin/authentication -H 'Content-type:application/json' \
    -d '{"set-user": {"solr" : "myPassword"}}'
</code></pre>
<p>you can initially index all active jobs by:</p>
<p>.. code-block:: sh</p>
<p>bin/console solr index job</p>
<p>Schema
^^^^^^</p>
<p>==================================== ===================================================================================
 fields
==================================== ===================================================================================
 id                                   Primary key
 applyId                              unique ID for the application
 title                                Job title
 city                                 city of the job opening
 dateCreated
 datePublishStart
 datePublishEnd
 dateModified
 lang                                 language of the job opening
 location                             location of the job posting (string)
 organizationName                     name of the hiring Organziation
 companyLogo                          logo of the hiring Organization
 entityName                           possible values "job" or "location"</p>
<p><em>_MultiString</em>                       Used by facets. E.g. region_MultiString, industry_MultiString,
                                      profession_MultiString
==================================== ===================================================================================</p>
<p>Description
^^^^^^^^^^^</p>
<p>YAWIK entities can be searched with the full text function of mongodb. This feature is great and usually sufficient, for
example, to offer jobs on your own career site. If you want to use YAWIK as a job board, the requirements increase. A
job exchange must be able to provide many jobs to many visitors. You need a search engine that scales. Currently Solr is
supported.</p>
<p>With the solr module, the search is outsourced to the Solr search engine. The module synchronizes the search index with
the jobs from the MongoDB.</p>
<p>Configuration
^^^^^^^^^^^^^</p>
<p>Since 0.9 you can use the following parameters to search</p>
<p>==================================== ===================================================================================
 parameter
==================================== ===================================================================================
 l                                    location
 d                                    distance
 q                                    query
 organizationTag                      company
 profession_Mutistring                profession
 industry_Multistring                 industry
 employmentType_Multistring           employmentType
==================================== ===================================================================================</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!--
MkDocs version : 1.1.2
Build Date UTC : 2021-01-06 11:53:03.978946+00:00
-->
